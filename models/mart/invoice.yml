models:
  - name: invoice
    description: The invoice model contains data on each invoice generated by a customer. The amount of each invoice has been converted to euros, and an extra columns that calculates the days between the start and end period of an invoice
    columns:
      - name: id
        description: invoice_id of each invoice
      - name: invoice_id
        description: This is the Foreign key. ID of an invoice

      - name: customer_id

      - name: type

      - name: currency

      - name: period_end

      - name: period_start

      - name: days_between_invoice_start_and_invoice_end_date

      - name: _synced

      - name: amount

      - name: amount_in_eur
      


semantic_models:
      - model: ref('int_invoice_amount_converted_to_eur')
        name: invoice
        description: | 
          Model containing the clean invoice data with amount converted to euros
        entities:
              - name: id
                type: primary
              - name: invoice
                type: foreign
                expr: invoice_id
              - name: customer
                type: foreign
                expr: customer_id

        dimensions:
              - name: type
                type: categorical
              - name: currency
                type: categorical
              - name: start_of_period
                type: time
                expr: period_start
                type_params:
                      time_granularity: day
              - name: end_of_period
                type: time
                expr: period_end
                type_params:
                      time_granularity: day
              - name: days_between_invoice_start_and_invoice_end_date
                type: categorical
              - name: synced_at
                type: time
                expr: _synced
                type_params:
                      time_granularity: day
                
        measures:
              - name: amount
                agg: sum

              - name: amount_in_eur
                agg: sum




metrics:
      - name: monthly_recurring_revenue
        label: Monthly Recurring Revenue
        description: Monthly Recurring Revenue (MRR) is the predictable total revenue generated by your business
                      from all the active subscriptions in a particular month.
        type: ratio
        type_params: 
            numerator: amount_in_eur
            denominator: days_between_invoice_start_and_invoice_end_date
              
          
      